(this.webpackJsonpblockchain=this.webpackJsonpblockchain||[]).push([[0],{106:function(t,e,n){t.exports=n(197)},111:function(t,e,n){},112:function(t,e,n){},113:function(t,e,n){},114:function(t,e,n){},118:function(t,e){},120:function(t,e){},154:function(t,e){},155:function(t,e){},197:function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),c=n(99),r=n.n(c),i=(n(111),n(112),n(17)),s=function(t){var e=Object(a.useState)(""),n=Object(i.a)(e,2),c=n[0],r=n[1];return Object(a.useEffect)((function(){var e=t.miner.observeProofOfWorkSearch().subscribe((function(t){return r(t)}));return function(){return e.unsubscribe()}})),o.a.createElement("span",null,"I am mining! ",c)},u=n(44),l=function(t){return o.a.createElement("div",null,"Transfer ",t.transaction.amount," from ",t.transaction.from," to ",t.transaction.to,".")},h=n(14),b=n(15),f=function(){function t(e,n,a){Object(h.a)(this,t),this._from=e,this._to=n,this._amount=a}return Object(b.a)(t,[{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"amount",get:function(){return this._amount}}]),t}(),k=function(t){var e=Object(a.useState)(""),n=Object(i.a)(e,2),c=n[0],r=n[1],s=Object(a.useState)(""),h=Object(i.a)(s,2),b=h[0],k=h[1],p=Object(a.useState)(1),m=Object(i.a)(p,2),O=m[0],v=m[1],d=Object(a.useState)(Object(u.a)(t.blockchain.openTransactions)),_=Object(i.a)(d,2),j=_[0],E=_[1];Object(a.useEffect)((function(){var e=t.blockchain.observeNewBlock().subscribe((function(){return E(Object(u.a)(t.blockchain.openTransactions))}));return function(){return e.unsubscribe()}}),[t.blockchain]);var g=j.map((function(t,e){return o.a.createElement(l,{key:e,transaction:t})}));return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("h2",{className:"title"},"Transactions"),"Transfer ",o.a.createElement("input",{"data-testid":"amount",className:"input",type:"text",value:O,onChange:function(t){var e=parseInt(t.target.value);v(e||1)}}),"from ",o.a.createElement("input",{"data-testid":"from",className:"input",type:"text",value:c,onChange:function(t){return r(t.target.value)}}),"to ",o.a.createElement("input",{"data-testid":"to",className:"input",type:"text",value:b,onChange:function(t){return k(t.target.value)}}),o.a.createElement("button",{"data-testid":"add",className:"button is-link",onClick:function(){var e=new f(c,b,O);t.blockchain.addOpenTransaction(e),E((function(t){return[].concat(Object(u.a)(t),[e])}))}},"Add")),o.a.createElement("div",null,"Currently there are ",g.length," open transactions."),o.a.createElement("div",null,g))},p=(n(113),function(t){var e=t.block.transactions.map((function(t){return"Transfered ".concat(t.amount," from ").concat(t.from," to ").concat(t.to)})).join(", ");return o.a.createElement("div",{className:"block box"},o.a.createElement("b",null,"Transactions:")," ",e,o.a.createElement("br",null),o.a.createElement("b",null,"Previous hash:")," ",t.block.previousHash,o.a.createElement("br",null),o.a.createElement("b",null,"Hash:")," ",t.block.hash,o.a.createElement("br",null),o.a.createElement("b",null,"Proof of work:")," ",t.block.proofOfWork)}),m=(n(114),function(t){var e=function(t){return t.map((function(t,e){return o.a.createElement(p,{key:e,block:t})})).reverse()},n=Object(a.useState)(e(t.blockchain.blocks)),c=Object(i.a)(n,2),r=c[0],s=c[1];return Object(a.useEffect)((function(){var n=t.blockchain.observeNewBlock().subscribe((function(){return s(e(t.blockchain.blocks))}));return function(){return n.unsubscribe()}}),[t.blockchain]),o.a.createElement("div",{className:"blockchain"},r)}),O=n(102),v=n(100),d=n(103),_=n(199),j=(n(115),n(25)),E=function(){function t(e,n,a){Object(h.a)(this,t),this._transactions=e,this._previousHash=n,this._proofOfWork=a,this._hash=void 0;var o=e.map((function(t){return"".concat(t.from).concat(t.to).concat(t.amount)})).join();this._hash=Object(j.createHash)("sha256").update(o).update("".concat(n)).update("".concat(a)).digest("hex")}return Object(b.a)(t,[{key:"transactions",get:function(){return this._transactions}},{key:"previousHash",get:function(){return this._previousHash}},{key:"hash",get:function(){return this._hash}},{key:"proofOfWork",get:function(){return this._proofOfWork}}]),t}(),g=n(101),W=function(){function t(){Object(h.a)(this,t),this._blockSubject=void 0,this._blocks=[],this._openTransactions=[];var e=new E([],"",123);this._blocks.push(e),this._blockSubject=new _.a(e)}return Object(b.a)(t,[{key:"observeNewBlock",value:function(){return this._blockSubject.asObservable()}},{key:"addOpenTransaction",value:function(t){this._openTransactions.push(t)}},{key:"addBlock",value:function(t){var e=this;console.debug("blockchain received a new proof of work",t);var n=new E(this._openTransactions.splice(0,10),this.top.hash,t);console.debug("blockchain created a new block",n),this._blocks.push(n);var a=this._blocks.pipe(new y((function(t,n){return e.checkBlocks(t,n)})));console.debug("blockchain was checked for consistency",a),a?(console.debug("blockchain propagates block"),this._blockSubject.next(n)):(console.debug("blockchain removes block"),this._blocks.pop())}},{key:"checkBlocks",value:function(e,n){return Object(j.createHash)("sha256").update("".concat(e.proofOfWork).concat(n.proofOfWork).concat(e.hash)).digest("hex").startsWith(t.PROOF_OF_WORK_CONSTRAINT)}},{key:"top",get:function(){return this._blocks[this._blocks.length-1]}},{key:"blocks",get:function(){return this._blocks}},{key:"openTransactions",get:function(){return this._openTransactions}}]),t}();W.PROOF_OF_WORK_CONSTRAINT="00";var y=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(O.a)(this,Object(v.a)(e).call(this))).reducer=t,n._lastBlock=void 0,n}return Object(d.a)(e,t),Object(b.a)(e,[{key:"getFallbackValue",value:function(){return!0}},{key:"perform",value:function(t){if(this._lastBlock){var e=this.reducer(this._lastBlock,t),n={value:e,done:!e};return this._lastBlock=t,n}return this._lastBlock=t,{value:!1,done:!1}}}]),e}(g.TerminalOperator);var N=n(104),w=n(200),T=n(202),S=n(201),B=function(){function t(e){var n=this;Object(h.a)(this,t),this._blockchain=e,this._proofOfWorkSubject=new N.a,this._subscriptions=[],this._top=void 0,this._proofOfWork=0,this._top=e.top,this._subscriptions.push(e.observeNewBlock().subscribe((function(t){n._top=t,n._proofOfWork=0}))),this._subscriptions.push(Object(w.a)(t.MINING_TIMEOUT).pipe(Object(S.a)((function(){return 0===n._proofOfWork?Object(T.a)(3e3):Object(T.a)(0)}))).subscribe((function(){return n.mine()})))}return Object(b.a)(t,[{key:"observeProofOfWorkSearch",value:function(){return this._proofOfWorkSubject.asObservable()}},{key:"mine",value:function(){this._proofOfWorkSubject.next("Currently checking ".concat(this._proofOfWork)),Object(j.createHash)("sha256").update("".concat(this._top.proofOfWork).concat(this._proofOfWork).concat(this._top.hash)).digest("hex").startsWith(W.PROOF_OF_WORK_CONSTRAINT)?(this._proofOfWorkSubject.next("Wohoo! ".concat(this._proofOfWork," worked. I am creating a new block.")),this._blockchain.addBlock(this._proofOfWork)):++this._proofOfWork}}]),t}();B.MINING_TIMEOUT=50;var x=function(){var t=new W,e=new B(t);return o.a.createElement("div",{className:"tile is-ancestor"},o.a.createElement("div",{className:"tile"},o.a.createElement("div",{className:"tile is-parent"},o.a.createElement("div",{className:"tile is-child box"},o.a.createElement(k,{blockchain:t}))),o.a.createElement("div",{className:"tile is-parent is-vertical"},o.a.createElement("div",{className:"tile is-child box"},o.a.createElement(s,{miner:e})),o.a.createElement("div",{className:"tile is-child box"},o.a.createElement(m,{blockchain:t})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[106,1,2]]]);
//# sourceMappingURL=main.d052b8ce.chunk.js.map